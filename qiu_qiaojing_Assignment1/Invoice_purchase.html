<script>
  // To get client's order data
  // Reference Lab 12
  let params = (new URL(document.location)).searchParams;
</script>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script src="products.js">
        //get product information
    </script>

<table border="5">
    <tbody>
      <tr>
        <th style="text-align: center;" width="30%">Service Name</th>
        <th style="text-align: center;" width="10%">Quantity</th>
        <th style="text-align: center;" width="10%">Unit Price</th>
        <th style="text-align: center;" width="15%">Extended Price</th>
        <th style="text-align: center;" width="50%">Tax Year</th>
        <th style="text-align: center;" width="100%">Name of the CPA</th>
      </tr>
    
    <script>
    // set quantities
    let quantities = params.get(quantity_textbox_name.value)
    //i=0;
    //i++;
    //if (params.has(product_textbox_name[i])) {
     // quantities.push(params.get(product_textbox_name[i].value))
    //}
    // set tax year
    let order_year = params.get(quantity_textbox_year.value)
    
    // set beginning subtotal to be 0
      subtotal = 0;
    // automative adding row function
      generate_item_rows(quantities);
      function generate_item_rows(product_quantities_array) {
      for (i=0; i < product_array.length; i++) {
        if (product_array[i] == 0) continue;
        extended_price = product_array[i].price * quantities[i];
        subtotal += extended_price;
        document.write(`  
      <tr>
        <td width="33%">${product_array[i].name}</td>
        <td align="center" width="10%">${quantities[i]}</td>
        <td align="center" width="10%">$${product_array[i].price}</td>
        <td align="center" width="15%">$${extended_price}</td>
        <td align="center" width="50%">${tax_year[i]}</td>
        <td align="center" width="100%">${product_array[i].CPA_name}</td>
      </tr>
    `); 
      }
    }

      // Compute tax
      var tax_rate = 0.045;
          var tax = subtotal * tax_rate;

      // Compute grand total
          var total = tax + subtotal;

    </script> 

      <tr>
        <td colspan="6" width="100%">&nbsp;</td>
      </tr>
     
     <script>
    document.write(`
      <tr>
        <td style="text-align: center;" colspan="3" width="50%">Sub total</td>
        <td colspan="3"align="center" width="50%">$${subtotal}</td>
      </tr>
     `); 
    </script> 
    <script> 
    document.write(`
      <tr>
        <td style="text-align: center;" colspan="3" width="67%"><span style="font-family: arial;">Tax @ ${100*tax_rate}%</span></td>
        <td colspan="3"align="center" width="54%">$${tax.toFixed(2)}</td>
      </tr>
    `);  
    </script>

    <script>
    document.write(`
      <tr>
        <td style="text-align: center;" colspan="3" width="67%"><strong>Total</strong></td>
        <td colspan="3"align="center" width="54%"><strong>$${total.toFixed(2)}</strong></td>
      </tr>
    `);
    </script>
    </tbody>
  </table>
  
  <p>This is your invoice. <br>If your have any question, please call us at (808)-123-4567. </p>
<style>
    body {
        background-color: ivory;
    }
    th {
        background-color: lightyellow;
        font-size: 18px;
        font-style: italic;
    }
    p {
        text-align: center;
        font-size: 30px;
        color: dimgray;
    }
    table {
        padding: 5px;
    }
</style>


</body>
</html>